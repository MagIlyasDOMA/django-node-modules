import requests
from typing import Optional
from django.urls import reverse
from .. import CACHE_HRENPACK_THEME_STYLE_CONFIG, CACHED_HRENPACK_THEME_STYLE_CONFIG, HRENPACK_THEME_STYLE_CONFIG_URL


def get_hrenpack_theme_style_jsdelivr_base_url(version: Optional[str] = None) -> str:
    return f"https://cdn.jsdelivr.net/npm/hrenpack-theme-style{('@' + version) if version else ''}"


def hrenpack_theme_style_config() -> dict:
    if CACHE_HRENPACK_THEME_STYLE_CONFIG:
        return CACHED_HRENPACK_THEME_STYLE_CONFIG
    return requests.get(HRENPACK_THEME_STYLE_CONFIG_URL).json()


def get_local_hrenpack_theme_style_base_url():
    return reverse('local_node_file', kwargs=dict(path='hrenpack-theme-style')).replace('\\', '/').rstrip('/')